{"ast":null,"code":"import axios from '../../axios/axios-quiz';\nimport { FETCH_QUIZES_START, FETCH_QUIZES_SUCCESS, FETCH_QUIZES_ERROR, FETCH_QUIZ_SUCCESS, QUIZ_SET_STATE } from './actionTypes';\nexport function fetchQuizes() {\n  return async dispatch => {\n    dispatch(fetchQuizesStart());\n\n    try {\n      const response = await axios.get('/quizes.json');\n      const quizes = [];\n      Object.keys(response.data).forEach((key, index) => {\n        quizes.push({\n          id: key,\n          name: `Тест №${index + 1}`\n        });\n      });\n      dispatch(fetchQuizesSuccess(quizes));\n    } catch (e) {\n      dispatch(fetchQuizesError(e));\n    }\n  };\n}\nexport function fetchQuizById(quizId) {\n  return async dispatch => {\n    dispatch(fetchQuizesStart());\n\n    try {\n      const response = await axios.get(`/quizes/${quizId}.json`);\n      const quiz = response.data;\n      dispatch(fetchQuizSuccess(quiz));\n    } catch (e) {\n      dispatch(fetchQuizesError(e));\n    }\n  };\n}\nexport function fetchQuizSuccess(quiz) {\n  return {\n    type: FETCH_QUIZ_SUCCESS,\n    quiz\n  };\n}\nexport function fetchQuizesStart() {\n  return {\n    type: FETCH_QUIZES_START\n  };\n}\nexport function fetchQuizesSuccess(quizes) {\n  return {\n    type: FETCH_QUIZES_SUCCESS,\n    quizes: quizes\n  };\n}\nexport function fetchQuizesError(e) {\n  return {\n    type: FETCH_QUIZES_ERROR,\n    error: e\n  };\n}\nexport function quizSetState(answerState, results) {\n  return {\n    type: QUIZ_SET_STATE,\n    answerState,\n    results\n  };\n}\nexport function quizAnswerClick(answerId) {\n  return (dispatch, getState) => {\n    const state = getState().quiz;\n\n    if (state.answerState) {\n      const key = Object.keys(this.state.answerState)[0];\n\n      if (state.answerState[key] === 'sucsess') {\n        return;\n      }\n    }\n\n    const question = state.quiz[state.activeQuestion];\n    const results = state.results;\n\n    if (question.rightAnswerId === answerId) {\n      if (!results[question.id]) {\n        results[question.id] = 'sucsess';\n      }\n\n      dispatch(quizSetState({\n        [answerId]: 'sucsess'\n      }, results));\n      const timeout = window.setTimeout(() => {\n        if (this.isQuizFinished()) {// this.setState({\n          // \tisFinished: true\n          // })     \n        } else {// \tthis.setState({\n            // \tactiveQuestion: this.state.activeQuestion + 1, \n            // \tanswerState: null\n            // })\n          }\n\n        window.clearTimeout(timeout);\n      }, 1000);\n    } else {\n      results[question.id] = 'error';\n      dispatch(quizSetState({\n        [answerId]: 'error'\n      }, results));\n    }\n  };\n}","map":{"version":3,"sources":["/Users/sergeymac/Web/React application /react-quiz(redux)/src/store/actions/quiz.js"],"names":["axios","FETCH_QUIZES_START","FETCH_QUIZES_SUCCESS","FETCH_QUIZES_ERROR","FETCH_QUIZ_SUCCESS","QUIZ_SET_STATE","fetchQuizes","dispatch","fetchQuizesStart","response","get","quizes","Object","keys","data","forEach","key","index","push","id","name","fetchQuizesSuccess","e","fetchQuizesError","fetchQuizById","quizId","quiz","fetchQuizSuccess","type","error","quizSetState","answerState","results","quizAnswerClick","answerId","getState","state","question","activeQuestion","rightAnswerId","timeout","window","setTimeout","isQuizFinished","clearTimeout"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,wBAAlB;AACA,SACCC,kBADD,EAECC,oBAFD,EAGCC,kBAHD,EAICC,kBAJD,EAKCC,cALD,QAMO,eANP;AAQA,OAAO,SAASC,WAAT,GAAuB;AAC7B,SAAO,MAAMC,QAAN,IAAkB;AACxBA,IAAAA,QAAQ,CAACC,gBAAgB,EAAjB,CAAR;;AACA,QAAI;AACA,YAAMC,QAAQ,GAAG,MAAMT,KAAK,CAACU,GAAN,CAAU,cAAV,CAAvB;AAEA,YAAMC,MAAM,GAAG,EAAf;AAEAC,MAAAA,MAAM,CAACC,IAAP,CAAYJ,QAAQ,CAACK,IAArB,EAA2BC,OAA3B,CAAmC,CAACC,GAAD,EAAMC,KAAN,KAAgB;AAC/CN,QAAAA,MAAM,CAACO,IAAP,CAAY;AACRC,UAAAA,EAAE,EAAEH,GADI;AAERI,UAAAA,IAAI,EAAG,SAAQH,KAAK,GAAG,CAAE;AAFjB,SAAZ;AAIH,OALD;AAMAV,MAAAA,QAAQ,CAACc,kBAAkB,CAACV,MAAD,CAAnB,CAAR;AACH,KAZD,CAYG,OAAOW,CAAP,EAAU;AACTf,MAAAA,QAAQ,CAACgB,gBAAgB,CAACD,CAAD,CAAjB,CAAR;AACH;AAED,GAlBD;AAmBA;AAED,OAAO,SAASE,aAAT,CAAuBC,MAAvB,EAA+B;AACrC,SAAO,MAAMlB,QAAN,IAAkB;AACxBA,IAAAA,QAAQ,CAACC,gBAAgB,EAAjB,CAAR;;AAEA,QAAI;AACC,YAAMC,QAAQ,GAAI,MAAMT,KAAK,CAACU,GAAN,CAAW,WAAUe,MAAO,OAA5B,CAAxB;AACA,YAAMC,IAAI,GAAGjB,QAAQ,CAACK,IAAtB;AAEAP,MAAAA,QAAQ,CAACoB,gBAAgB,CAACD,IAAD,CAAjB,CAAR;AACD,KALJ,CAKK,OAAOJ,CAAP,EAAU;AACVf,MAAAA,QAAQ,CAACgB,gBAAgB,CAACD,CAAD,CAAjB,CAAR;AACD;AACJ,GAXD;AAYA;AAED,OAAO,SAASK,gBAAT,CAA0BD,IAA1B,EAAgC;AACtC,SAAO;AACNE,IAAAA,IAAI,EAAExB,kBADA;AAENsB,IAAAA;AAFM,GAAP;AAKA;AAED,OAAO,SAASlB,gBAAT,GAA4B;AAClC,SAAO;AACNoB,IAAAA,IAAI,EAAE3B;AADA,GAAP;AAGA;AAED,OAAO,SAASoB,kBAAT,CAA4BV,MAA5B,EAAoC;AAC1C,SAAO;AACNiB,IAAAA,IAAI,EAAE1B,oBADA;AAENS,IAAAA,MAAM,EAAEA;AAFF,GAAP;AAIA;AAED,OAAO,SAASY,gBAAT,CAA0BD,CAA1B,EAA6B;AACnC,SAAO;AACNM,IAAAA,IAAI,EAAEzB,kBADA;AAEN0B,IAAAA,KAAK,EAAEP;AAFD,GAAP;AAIA;AAED,OAAO,SAASQ,YAAT,CAAsBC,WAAtB,EAAmCC,OAAnC,EAA4C;AAClD,SAAO;AACNJ,IAAAA,IAAI,EAAEvB,cADA;AAEN0B,IAAAA,WAFM;AAEOC,IAAAA;AAFP,GAAP;AAIA;AAED,OAAO,SAASC,eAAT,CAAyBC,QAAzB,EAAmC;AACzC,SAAO,CAAC3B,QAAD,EAAW4B,QAAX,KAAwB;AAC9B,UAAMC,KAAK,GAAGD,QAAQ,GAAGT,IAAzB;;AACE,QAAIU,KAAK,CAACL,WAAV,EAAuB;AACpB,YAAMf,GAAG,GAAGJ,MAAM,CAACC,IAAP,CAAY,KAAKuB,KAAL,CAAWL,WAAvB,EAAoC,CAApC,CAAZ;;AACA,UAAIK,KAAK,CAACL,WAAN,CAAkBf,GAAlB,MAA2B,SAA/B,EAA0C;AACzC;AACA;AACH;;AAED,UAAMqB,QAAQ,GAAGD,KAAK,CAACV,IAAN,CAAWU,KAAK,CAACE,cAAjB,CAAjB;AACM,UAAMN,OAAO,GAAGI,KAAK,CAACJ,OAAtB;;AAEN,QAAGK,QAAQ,CAACE,aAAT,KAA2BL,QAA9B,EAAwC;AAEvC,UAAG,CAACF,OAAO,CAACK,QAAQ,CAAClB,EAAV,CAAX,EAA0B;AACzBa,QAAAA,OAAO,CAACK,QAAQ,CAAClB,EAAV,CAAP,GAAuB,SAAvB;AACA;;AAEDZ,MAAAA,QAAQ,CAACuB,YAAY,CAAC;AAAC,SAACI,QAAD,GAAY;AAAb,OAAD,EAA0BF,OAA1B,CAAb,CAAR;AAEA,YAAMQ,OAAO,GAAGC,MAAM,CAACC,UAAP,CAAkB,MAAM;AAEvC,YAAI,KAAKC,cAAL,EAAJ,EAA2B,CAC1B;AACA;AACA;AACA,SAJD,MAIO,CACN;AACA;AACA;AACA;AAEA;;AAEDF,QAAAA,MAAM,CAACG,YAAP,CAAoBJ,OAApB;AAEA,OAhBe,EAgBb,IAhBa,CAAhB;AAoBA,KA5BD,MA4BO;AACNR,MAAAA,OAAO,CAACK,QAAQ,CAAClB,EAAV,CAAP,GAAuB,OAAvB;AACAZ,MAAAA,QAAQ,CAACuB,YAAY,CAAC;AAAC,SAACI,QAAD,GAAY;AAAb,OAAD,EAAwBF,OAAxB,CAAb,CAAR;AACA;AACH,GA5CD;AA8CA","sourcesContent":["import axios from '../../axios/axios-quiz'\nimport {\n\tFETCH_QUIZES_START, \n\tFETCH_QUIZES_SUCCESS, \n\tFETCH_QUIZES_ERROR, \n\tFETCH_QUIZ_SUCCESS,\n\tQUIZ_SET_STATE\n} from './actionTypes'\n\nexport function fetchQuizes() {\n\treturn async dispatch => {\n\t\tdispatch(fetchQuizesStart())\n\t\ttry {\n\t\t    const response = await axios.get('/quizes.json')\n\n\t\t    const quizes = []\n\n\t\t    Object.keys(response.data).forEach((key, index) => {\n\t\t        quizes.push({\n\t\t            id: key,\n\t\t            name: `Тест №${index + 1}`\n\t\t        })\n\t\t    })\n\t\t    dispatch(fetchQuizesSuccess(quizes))\n\t\t}  catch (e) {\n\t\t    dispatch(fetchQuizesError(e))\n\t\t}\n\n\t}\n}\n\nexport function fetchQuizById(quizId) {\n\treturn async dispatch => {\n\t\tdispatch(fetchQuizesStart())\n\n\t\ttry {\n    \t  const response =  await axios.get(`/quizes/${quizId}.json`)\n    \t  const quiz = response.data\n\n    \t  dispatch(fetchQuizSuccess(quiz))\n    \t} catch (e) {\n    \t  dispatch(fetchQuizesError(e))\n    \t}\n\t}\n}\n\nexport function fetchQuizSuccess(quiz) {\n\treturn {\n\t\ttype: FETCH_QUIZ_SUCCESS,\n\t\tquiz\n\t}\n\n}\n\nexport function fetchQuizesStart() {\n\treturn {\n\t\ttype: FETCH_QUIZES_START\n\t}\n}\n\nexport function fetchQuizesSuccess(quizes) {\n\treturn {\n\t\ttype: FETCH_QUIZES_SUCCESS,\n\t\tquizes: quizes\n\t}\n}\n\nexport function fetchQuizesError(e) {\n\treturn {\n\t\ttype: FETCH_QUIZES_ERROR,\n\t\terror: e\n\t}\n}\n\nexport function quizSetState(answerState, results) {\n\treturn {\n\t\ttype: QUIZ_SET_STATE,\n\t\tanswerState, results\n\t}\n}\n\nexport function quizAnswerClick(answerId) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState().quiz\n\t\t\t\tif (state.answerState) {\n\t\t\t\t\t  const key = Object.keys(this.state.answerState)[0]\n\t\t\t\t\t  if (state.answerState[key] === 'sucsess') {\n\t\t\t\t\t  \treturn\n\t\t\t\t\t  }\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst question = state.quiz[state.activeQuestion]\n\t\t        const results = state.results\n\n\t\t\t\tif(question.rightAnswerId === answerId) {\n\n\t\t\t\t\tif(!results[question.id]) {\n\t\t\t\t\t\tresults[question.id] = 'sucsess'\n\t\t\t\t\t}\n\n\t\t\t\t\tdispatch(quizSetState({[answerId]: 'sucsess'}, results))\n\n\t\t\t\t\tconst timeout = window.setTimeout(() => {\n\n\t\t\t\t\t\tif (this.isQuizFinished()) {\n\t\t\t\t\t\t\t// this.setState({\n\t\t\t\t\t\t\t// \tisFinished: true\n\t\t\t\t\t\t\t// })     \n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// \tthis.setState({\n\t\t\t\t\t\t\t// \tactiveQuestion: this.state.activeQuestion + 1, \n\t\t\t\t\t\t\t// \tanswerState: null\n\t\t\t\t\t\t\t// })\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow.clearTimeout(timeout)\n\n\t\t\t\t\t}, 1000)\n\n\t\t\t\t\t\n\n\t\t\t\t} else {\n\t\t\t\t\tresults[question.id] = 'error'\n\t\t\t\t\tdispatch(quizSetState({[answerId]: 'error'}, results))\n\t\t\t\t}\n\t}\n\n}"]},"metadata":{},"sourceType":"module"}